FROM node:alpine

ADD . prj
WORKDIR prj

RUN npm run setup
RUN npm run build

RUN rm -rf test/ node_modules/ && rm -f src/*.ts src/**/*.ts
RUN npm run setup-prod

CMD ["npm", "run", "start-prod"]
